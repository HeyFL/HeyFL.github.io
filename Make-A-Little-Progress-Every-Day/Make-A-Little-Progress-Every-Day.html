<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>每天进步一点点 - 神奇宝贝大师的技术博客</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="[原创]个人理解，请批判接受，有误请指正。转载请注明出处: https://heyfl.github.io/Make-A-Little-Progress-Every-Day/Make-A-Little-Progress-Every-Day.html  2019-08-26  官方参考  MySQL锁   InnoDB锁机制是基于索引建立的 如果SQL语句中匹配不到索引,那么就会升级为表锁"><meta name="keywords" content="每天进步一点点"><meta property="og:type" content="article"><meta property="og:title" content="每天进步一点点"><meta property="og:url" content="https://heyfl.github.io/Make-A-Little-Progress-Every-Day/Make-A-Little-Progress-Every-Day.html"><meta property="og:site_name" content="神奇宝贝大师的技术博客"><meta property="og:description" content="[原创]个人理解，请批判接受，有误请指正。转载请注明出处: https://heyfl.github.io/Make-A-Little-Progress-Every-Day/Make-A-Little-Progress-Every-Day.html  2019-08-26  官方参考  MySQL锁   InnoDB锁机制是基于索引建立的 如果SQL语句中匹配不到索引,那么就会升级为表锁"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://heyfl.github.io/images/%E5%B9%B6%E5%8F%91/ThreadLocal.png"><meta property="og:updated_time" content="2019-08-26T11:17:24.741Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="每天进步一点点"><meta name="twitter:description" content="[原创]个人理解，请批判接受，有误请指正。转载请注明出处: https://heyfl.github.io/Make-A-Little-Progress-Every-Day/Make-A-Little-Progress-Every-Day.html  2019-08-26  官方参考  MySQL锁   InnoDB锁机制是基于索引建立的 如果SQL语句中匹配不到索引,那么就会升级为表锁"><meta name="twitter:image" content="https://heyfl.github.io/images/%E5%B9%B6%E5%8F%91/ThreadLocal.png"><link rel="icon" href="/images/avatar.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><link rel="stylesheet" href="/css/back-to-top.css"><link rel="stylesheet" href="/css/progressbar.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="/css/style.css"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand is-flex-center"> <a class="navbar-item navbar-logo" href="/"><img src="/images/avatar.png" alt="每天进步一点点" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"> <a class="navbar-item" href="/">主页</a> <a class="navbar-item" href="/archives">归档</a> <a class="navbar-item" href="/categories">分类</a> <a class="navbar-item" href="/tags">标签</a> <a class="navbar-item" href="/about.html">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/HeyFL" rel="external nofollow noopener noreferrer"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container" style="max-width:80vw;width:80vw"><div class="columns"><div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main"><div class="card" style="border-style:solid;border-width:2px;border-color:#737373"><div class="card-content article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"> 每天进步一点点</h1><div class="post-meta"><div class="level-left" style="width:100%;display:block;text-align:center"><span><i class="far fa-calendar-alt"></i> <span>发表于</span> <span>2018-09-05</span></span> <span class="post-meta-divider">|</span><span class="far fa-eye"></span> <span id="busuanzi_container_page_pv" class="level-item has-text-grey">被围观 <span id="busuanzi_value_page_pv" class="foot-count">无数</span> 次</span><br><span><span class="far fa-folder"></span> <span>分类于</span> <span class="is-size-6 has-text-grey has-mr-7">#</span> <a class="has-link-grey -link" href="/tags/每天进步一点点/">每天进步一点点</a></span> <span class="post-meta-divider">|</span><i class="far fa-clock"></i> <span>44 分钟 读完 (大约 6531 个字)</span></div></div><div class="content"><blockquote><p><font size="3" color="red">[原创]</font>个人理解，请批判接受，有误请指正。转载请注明出处: <a href="#">https://heyfl.github.io/Make-A-Little-Progress-Every-Day/Make-A-Little-Progress-Every-Day.html</a></p></blockquote><h2 id="2019-08-26">2019-08-26</h2><blockquote><p><a href="https://docs.oracle.com/cd/E17952_01/mysql-5.0-en/innodb-record-level-locks.html" rel="external nofollow noopener noreferrer" target="_blank">官方参考</a></p></blockquote><h3 id="mysql锁">MySQL锁</h3><blockquote><ul><li>InnoDB锁机制是基于索引建立的</li><li>如果SQL语句中匹配不到索引,那么就会升级为表锁</li></ul></blockquote><h4 id="记录锁">记录锁</h4><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">-- id 列为主键列或唯一索引列</span></span><br><span class="line"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span> = <span class="hljs-number">1</span> <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">UPDATE</span>;</span><br><span class="line">或</span><br><span class="line"><span class="hljs-keyword">update</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">set</span> age=<span class="hljs-number">2</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span> = <span class="hljs-number">1</span>;</span><br></pre></td></tr></table></figure><blockquote><p>通过唯一索引实现的记录锁,只会锁住当前记录(必须为<code>=</code>不然会退化为<code>临键锁</code>)</p></blockquote><h4 id="间隙锁">间隙锁</h4><blockquote><ul><li><strong>间隙锁<code>只有</code>在事务隔离级别 <code>RR(可重复读)</code>中才会生效</strong>.</li><li>为非唯一索引组成(如class,age等)</li></ul></blockquote><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">select</span> student <span class="hljs-keyword">where</span> age&gt;<span class="hljs-number">26</span> <span class="hljs-keyword">and</span> age&lt;<span class="hljs-number">28</span> <span class="hljs-keyword">lock</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">share</span> <span class="hljs-keyword">mode</span> ;</span><br></pre></td></tr></table></figure><h5 id="使用间隙锁的条件">使用间隙锁的条件</h5><ul><li>命中普通索引锁定；</li><li>使用多列唯一索引；</li><li>使用唯一索引命中多行记录</li></ul><h5 id="临键锁-next-key-locks">临键锁(Next-key Locks)</h5><ul><li><strong>==临键锁<code>只有</code>在事务隔离级别 <code>RR(可重复读)</code>中才会生效==</strong></li><li>是记录锁与间隙锁的组合</li><li>可以是<code>唯一索引</code>,也可以是<code>非唯一索引</code>,对其都以间隙锁的形式进行锁定(<code>以唯一索引匹配,并且只匹配到一条数据除外</code>)</li></ul><h6 id="临键锁-next-key-locks-例子">临键锁(Next-key Locks) 例子:</h6><table><thead><tr><th>tno<code>(唯一索引)</code></th><th>tname</th><th>tsex</th><th>tbirthday</th><th>prof</th><th>depart</th><th>age<code>(非唯一索引)</code></th></tr></thead><tbody><tr><td>858</td><td>张旭</td><td>1</td><td>1969-03-12</td><td>讲师</td><td>电子工程系</td><td>25</td></tr><tr><td>857</td><td>张旭</td><td>女1</td><td>1969-03-12</td><td>讲师</td><td>电子工程系</td><td>25</td></tr><tr><td>856</td><td>张旭</td><td>男</td><td>1969-03-12</td><td>讲师</td><td>电子工程系</td><td>25</td></tr><tr><td>831</td><td>刘冰</td><td>女</td><td>1977-08-14</td><td>助教</td><td>电子工程系</td><td>29</td></tr><tr><td>825</td><td>王萍</td><td>女</td><td>1972-05-05</td><td>助教</td><td>计算机系</td><td>28</td></tr><tr><td>804</td><td>李诚</td><td>男</td><td>1958-12-02</td><td>副教授</td><td>计算机系</td><td>26</td></tr></tbody></table><blockquote><p>其中有唯一索引的<code>临键</code>为:<br> (-∞,804]<br> (804,825]<br> (825,831]<br> (831,856]<br> (856,857]<br> (857,858]<br> (858,+∞]</p></blockquote><blockquote><p>其中有非唯一索引的<code>临键</code>为:<br> (-∞,25]<br> (25,26]<br> (26,28]<br> (28,29]<br> (29,+∞]</p></blockquote><h6 id="非唯一索引临键锁验证"><strong><code>非唯一索引</code>临键锁验证</strong></h6><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">-- session1</span></span><br><span class="line"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> teacher <span class="hljs-keyword">WHERE</span> age <span class="hljs-keyword">between</span> <span class="hljs-number">26</span> <span class="hljs-keyword">and</span> <span class="hljs-number">28</span> <span class="hljs-keyword">lock</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">share</span> <span class="hljs-keyword">mode</span> ;</span><br></pre></td></tr></table></figure><blockquote><p>这时候会锁定非唯一索引的<code>临键</code> <code>(25,29]</code><br> 所以我们测试更新age=25–&gt;成功 插入age=27阻塞 更新age=29阻塞 插入age=30成功即可验证</p></blockquote><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">-- session2</span></span><br><span class="line"><span class="hljs-comment">-- 更新age=25--&gt;成功</span></span><br><span class="line"><span class="hljs-keyword">update</span> teacher <span class="hljs-keyword">set</span> tsex=<span class="hljs-string">'女1'</span> <span class="hljs-keyword">WHERE</span> age=<span class="hljs-number">25</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">-- 插入age=27阻塞</span></span><br><span class="line"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-string">`test`</span>.<span class="hljs-string">`teacher`</span> ( <span class="hljs-string">`tno`</span>, <span class="hljs-string">`tname`</span>, <span class="hljs-string">`tsex`</span>, <span class="hljs-string">`tbirthday`</span>, <span class="hljs-string">`prof`</span>, <span class="hljs-string">`depart`</span>,<span class="hljs-string">`age`</span>) <span class="hljs-keyword">values</span> ( <span class="hljs-string">'740'</span>, <span class="hljs-string">'张旭1'</span>, <span class="hljs-string">'12'</span>, <span class="hljs-string">'1969-03-12 00:00:00'</span>, <span class="hljs-string">'讲师'</span>, <span class="hljs-string">'电子工程系'</span>,<span class="hljs-number">27</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">-- 更新age=29--&gt;阻塞</span></span><br><span class="line"><span class="hljs-keyword">update</span> teacher <span class="hljs-keyword">set</span> tsex=<span class="hljs-string">'女1'</span> <span class="hljs-keyword">WHERE</span> age=<span class="hljs-number">29</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">-- 更新age=30--&gt;成功</span></span><br><span class="line"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-string">`test`</span>.<span class="hljs-string">`teacher`</span> ( <span class="hljs-string">`tno`</span>, <span class="hljs-string">`tname`</span>, <span class="hljs-string">`tsex`</span>, <span class="hljs-string">`tbirthday`</span>, <span class="hljs-string">`prof`</span>, <span class="hljs-string">`depart`</span>,<span class="hljs-string">`age`</span>) <span class="hljs-keyword">values</span> ( <span class="hljs-string">'740'</span>, <span class="hljs-string">'张旭1'</span>, <span class="hljs-string">'12'</span>, <span class="hljs-string">'1969-03-12 00:00:00'</span>, <span class="hljs-string">'讲师'</span>, <span class="hljs-string">'电子工程系'</span>,<span class="hljs-number">30</span>);</span><br></pre></td></tr></table></figure><h6 id="唯一索引临键锁验证"><strong><code>唯一索引</code>临键锁验证</strong></h6><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">-- session1</span></span><br><span class="line"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> teacher <span class="hljs-keyword">WHERE</span> tno <span class="hljs-keyword">between</span> <span class="hljs-string">"831"</span> <span class="hljs-keyword">and</span> <span class="hljs-string">"856"</span> <span class="hljs-keyword">lock</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">share</span> <span class="hljs-keyword">mode</span> ;</span><br></pre></td></tr></table></figure><blockquote><p>根据上面的sql,我们匹配到<code>唯一索引</code>临键锁为:<code>(825,857]</code><br> 所以我们测试更新tno=825–&gt;成功 更新tno=857阻塞 更新age=858成功即可验证</p></blockquote><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">-- 更新tno="825"--&gt;成功</span></span><br><span class="line"><span class="hljs-keyword">update</span> teacher <span class="hljs-keyword">set</span> tsex=<span class="hljs-string">'女1'</span> <span class="hljs-keyword">WHERE</span> tno=<span class="hljs-string">"825"</span>;</span><br><span class="line"><span class="hljs-comment">-- 更新tno="857"--&gt;阻塞</span></span><br><span class="line"><span class="hljs-keyword">update</span> teacher <span class="hljs-keyword">set</span> tsex=<span class="hljs-string">'女1'</span> <span class="hljs-keyword">WHERE</span> tno=<span class="hljs-string">"857"</span>;</span><br><span class="line"><span class="hljs-comment">-- 更新tno="858"--&gt;成功</span></span><br><span class="line"><span class="hljs-keyword">update</span> teacher <span class="hljs-keyword">set</span> tsex=<span class="hljs-string">'女1'</span> <span class="hljs-keyword">WHERE</span> tno=<span class="hljs-string">"858"</span>;</span><br></pre></td></tr></table></figure><h2 id="2019-08-22">2019-08-22</h2><h3 id="spring事务-aop增强">Spring事务/AOP增强</h3><ul><li><code>@EnableAspectJAutoProxy(exposeProxy = true)</code></li></ul><ol><li>进入代理时,通过<code>AopContext.serCurrentProxy(proxy)</code>把当前代理设置到ThreadLocal中</li><li>后续在线程销毁(请求结束)前调用代理内部之间的调用就可以通过<code>((AService)AopContext.currentProxy()).b()</code>进行调用了</li><li>PS. 性能影响不大 不过实际上代理内部之间还需要AOP增强的场景不多,一般没必要用</li></ol><h3 id="spring-ltw实现的静态织入-应该不能叫做代理">Spring LTW实现的静态织入<code>（应该不能叫做代理）</code></h3><blockquote><ul><li>需要添加配置：</li></ul><ol><li>代码添加: <code>@EnableLoadTimeWeaving(aspectjWeaving=ENABLED)</code>或<code>&lt;context:load-time-weaver aspectj-weaving=&quot;enable&quot; /&gt;</code></li><li>添加JVM参数<code>-javaagent:类加载器代理路径</code></li></ol></blockquote><ol><li><p><code>LTW(LoadTime Weaving)</code><br> 加载时织入。在通过JVM加载类时候会先调用<code>ClassTransformer</code>的<code>transform()</code>进行字节码替换后才会进行加载。</p></li><li><p><code>静态AOP</code><br> 通过<code>LTW</code>可以实现<code>静态AOP</code>增强，加载到的类就是已经增强后的代码。这样我们调用方法的时候,直接就是调用了增强后的方法,比起动态代理的调用,更加地高效。</p></li></ol><p>上述流程大致如下所示:</p><pre class="mermaid">graph TD
A[Target]
B[增强后的字节码]
C[加载后的代码]
D[注入后的Bean]
E[调用方]
A--ClassTransformer的transform方法进行字节码植入-->B
B--JVM加载-->C
C--Spring使用,创建/注入Bean-->D
E--方法调用-->D</pre><h2 id="2019-08-01">2019-08-01</h2><h3 id="spring事务">Spring事务</h3><blockquote><p>对于this.b()这些类实例的内部调用，b()实际上是无事务的<br> 但是可以用<code>((AService)AopContext.currentProxy()).b()</code> 结合<code>@EnableAspectJAutoProxy(exposeProxy = true)</code> 这样b()就包裹在事务里了</p></blockquote><h2 id="2019-7-20">2019-7-20</h2><h3 id="seata">seata</h3><ul><li>seata需要管理所有的数据库操作，不然不能通过前镜像进行回滚</li></ul><h2 id="2019-7-17">2019-7-17</h2><h3 id="spring事务-cglib">Spring事务/Cglib</h3><ol><li>final,static,private修饰符无法被增强</li></ol><blockquote><p>由于使用final,static,private修饰符的方法都不能被子类覆盖，相应的，这些方法将不能被实施的AOP增强</p></blockquote><ol start="2"><li>增强应该作用在实现类中</li></ol><blockquote><p>@Transactional 注解可以作用于接口、接口方法、类以及类方法上，但是 Spring 建议不要在接口或者接口方法上使用该注解，因为这只有在使用基于接口的代理时它才会生效。</p></blockquote><h2 id="2019-5-20">2019-5-20</h2><h3 id="gc日志-gc耗时解析">【GC日志】GC耗时解析</h3><blockquote><p>【Time: user=0.71 sys=0.01 real=0.02 secs】</p><ol><li>user表示：本次GC过程中【所有线程】在用户态消耗的时间总和</li><li>sys表示： 本次GC过程中 【所有线程】在内核态所消耗的时间总和</li><li>real表示：本次GC过程中，实际GC消耗的时间</li></ol></blockquote><h2 id="2019-5-1">2019-5-1</h2><h3 id="数据库mvcc">数据库MVCC</h3><blockquote><ul><li>MVCC：多版本并发控制(Multi-Version Concurrency Control)</li><li>优势：查询速度快，并发环境尤是。<strong><font color="red">对于大多数读操作，我们只需要通过MVCC进行简单的查询操作，而不需要获取任何一个<code>锁</code>。</font></strong></li><li>劣势：需要多存储数据。<strong><font color="blue">对每一条记录都需要存储所有版本的数据</font></strong></li><li><strong><font color="red">MVCC只工作在REPEATABLE READ和READ COMMITED隔离级别下</font></strong></li><li>READ UNCOMMITED不是MVCC兼容：因为这个模式只能读取到最新的数据</li><li>SERIABLABLE也不与MVCC兼容：因为每个读操作都需要为读到的数据上锁</li></ul></blockquote><hr><h4 id="mvvc机制：">MVVC机制：</h4><blockquote><ul><li>以下摘自<a href="https://mp.weixin.qq.com/s/vRf5p9c9_4GrmFLaqEZI6w" rel="external nofollow noopener noreferrer" target="_blank">《五分钟搞清楚 MVCC 机制》</a></li></ul></blockquote><ol><li><p>每一条数据库表记录,都隐藏2个字段</p><ul><li>数据行的版本号 （DB_TRX_ID）</li><li>删除版本号 (DB_ROLL_PT)</li></ul></li><li><p>执行insert语句插入的时候,会把当前的事务ID写到该记录的数据行的版本号 （DB_TRX_ID）中:</p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">begin;-- 获取到全局事务ID</span><br><span class="line">insert into `test_zq` (`id`, `test_id`) values(&apos;5&apos;,&apos;68&apos;);</span><br><span class="line">insert into `test_zq` (`id`, `test_id`) values(&apos;6&apos;,&apos;78&apos;);</span><br><span class="line">commit;-- 提交事务</span><br></pre></td></tr></table></figure><table><thead><tr><th>id</th><th>test_id</th><th>DB_TRX_ID</th><th>DB_ROLL_PT</th></tr></thead><tbody><tr><td>5</td><td>68</td><td>1</td><td>NULL</td></tr><tr><td>6</td><td>78</td><td>1</td><td>NULL</td></tr></tbody></table></li><li><p>修改数据库记录的时候</p><ol><li>更新原记录的删除版本号 (DB_ROLL_PT)为当前事务ID</li><li>插入一行新的更新后的记录,且它的数据行的版本号 （DB_TRX_ID）为当前事务ID</li></ol><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin;-- 获取全局系统事务ID 假设为 10</span><br><span class="line">update test_zq set test_id = 22 where id = 5;</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure><table><thead><tr><th>id</th><th>test_id</th><th>DB_TRX_ID</th><th>DB_ROLL_PT</th></tr></thead><tbody><tr><td>5</td><td>68</td><td>1</td><td>10</td></tr><tr><td>6</td><td>78</td><td>1</td><td>3</td></tr><tr><td>5</td><td>22</td><td>10</td><td>NULL</td></tr></tbody></table></li><li><p>查询的时候需要根据<code>数据行的版本号 （DB_TRX_ID）</code> 和 <code>删除版本号 (DB_ROLL_PT)</code> 二者进行数据数据筛选，需要同时满足以下规则：</p><ol><li><code>数据行的版本号 （DB_TRX_ID）</code> &lt;= 当前事务</li><li><code>删除版本号 (DB_ROLL_PT)</code> &gt; 当前事务</li></ol><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin;-- 假设拿到的系统事务ID为 10</span><br><span class="line">select * from test_zq;</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure><table><thead><tr><th>id</th><th>test_id</th><th>DB_TRX_ID</th><th>DB_ROLL_PT</th></tr></thead><tbody><tr><td>6</td><td>22</td><td>10</td><td>NULL</td></tr></tbody></table></li></ol><h2 id="2019-04-24">2019-04-24</h2><h3 id="spring的lifecycle-springappilication生命周期">Spring的Lifecycle (SpringAppilication生命周期)</h3><blockquote><p>Spring会拿到所有Lifecycle实现类，然后委托DefaultLifecycleProcessor进行逐个处理</p></blockquote><ul><li>Lifecycle 可以在SpringAppilication在初始化后执行start()方法,Spring停止的时候调用stop()方法</li><li>但是单单实现该类不能实现SpringAppilication在启动后,停止时调用Lifecycle对应的方法</li><li>这时候我们应该需要使用SmartLifecycle（Lifecycle的子类）,重写isAutoStartup()返回true，才能产生理想效果</li></ul><h2 id="2019-04-23">2019-04-23</h2><h3 id="关于测试类的规范">关于测试类的规范</h3><ol><li>单元测试应该是不依赖于别的单元测试的</li><li>所有单元测试应该都得回滚，如果存在异步处理的情况，应尽可能把主线程与fork线程拆成2个测试类方法进行测试</li><li>每个测试类／测试方法应写上对应的名称@DisplayName</li><li>每个接口，都必须写一个正向测试方法</li><li>关于测试类的类名：测试类与被测试的类的路径需要一致，名字也需要对应，如：</li></ol><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">com.fpx.wms.service.impl.InstockServiceImpl</span><br><span class="line">↓对应↓</span><br><span class="line">com.fpx.wms.service.impl.InstockServiceImplTest</span><br></pre></td></tr></table></figure><ol start="6"><li>关于测试类的方法名： 方法名尽可能为成功的条件如shouldSuccessAfterPay()，而方法具体用来测试哪个场景的，我们已经使用了@ DisplayName来描述，无须担心</li><li>对于结果，需要适应assert断言输出与结</li></ol><blockquote><p><font size="3" color="red">[原创]</font>个人理解，请批判接受，有误请指正。转载请注明出处: <a href="#">https://heyfl.github.io/Make-A-Little-Progress-Every-Day/Make-A-Little-Progress-Every-Day.html</a></p></blockquote><h2 id="2019-08-22-v2">2019-08-22</h2><h3 id="spring事务-aop增强-v2">Spring事务/AOP增强</h3><ul><li><code>@EnableAspectJAutoProxy(exposeProxy = true)</code></li></ul><ol><li>进入代理时,通过<code>AopContext.serCurrentProxy(proxy)</code>把当前代理设置到ThreadLocal中</li><li>后续在线程销毁(请求结束)前调用代理内部之间的调用就可以通过<code>((AService)AopContext.currentProxy()).b()</code>进行调用了</li><li>PS. 性能影响不大 不过实际上代理内部之间还需要AOP增强的场景不多,一般没必要用</li></ol><h2 id="2019-08-01-v2">2019-08-01</h2><h3 id="spring事务-v2">Spring事务</h3><blockquote><p>对于this.b()这些类实例的内部调用，b()实际上是无事务的<br> 但是可以用<code>((AService)AopContext.currentProxy()).b()</code> 结合<code>@EnableAspectJAutoProxy(exposeProxy = true)</code> 这样b()就包裹在事务里了</p></blockquote><h2 id="2019-7-20-v2">2019-7-20</h2><h3 id="seata-v2">seata</h3><p>seata需要管理所有的数据库操作，不然不能通过前镜像进行回滚</p><h2 id="2019-7-17-v2">2019-7-17</h2><h3 id="spring事务-cglib-v2">Spring事务/Cglib</h3><ol><li>final,static,private修饰符无法被增强</li></ol><blockquote><p>由于使用final,static,private修饰符的方法都不能被子类覆盖，相应的，这些方法将不能被实施的AOP增强</p></blockquote><ol start="2"><li>增强应该作用在实现类中</li></ol><blockquote><p>@Transactional 注解可以作用于接口、接口方法、类以及类方法上，但是 Spring 建议不要在接口或者接口方法上使用该注解，因为这只有在使用基于接口的代理时它才会生效。</p></blockquote><h2 id="2019-5-20-v2">2019-5-20</h2><h3 id="gc日志-gc耗时解析-v2">【GC日志】GC耗时解析</h3><blockquote><p>【Time: user=0.71 sys=0.01 real=0.02 secs】</p><ol><li>user表示：本次GC过程中【所有线程】在用户态消耗的时间总和</li><li>sys表示： 本次GC过程中 【所有线程】在内核态所消耗的时间总和</li><li>real表示：本次GC过程中，实际GC消耗的时间</li></ol></blockquote><h2 id="2019-5-1-v2">2019-5-1</h2><h3 id="数据库mvcc-v2">数据库MVCC</h3><p><a href="https://mp.weixin.qq.com/s/vRf5p9c9_4GrmFLaqEZI6w" rel="external nofollow noopener noreferrer" target="_blank">《五分钟搞清楚 MVCC 机制》</a></p><ol><li><p>每一条数据库表记录,都隐藏2个字段</p><ul><li>数据行的版本号 （DB_TRX_ID）</li><li>删除版本号 (DB_ROLL_PT)</li></ul></li><li><p>执行insert语句插入的时候,会把当前的事务ID写到该记录的数据行的版本号 （DB_TRX_ID）中:</p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">begin;-- 获取到全局事务ID</span><br><span class="line">insert into `test_zq` (`id`, `test_id`) values(&apos;5&apos;,&apos;68&apos;);</span><br><span class="line">insert into `test_zq` (`id`, `test_id`) values(&apos;6&apos;,&apos;78&apos;);</span><br><span class="line">commit;-- 提交事务</span><br></pre></td></tr></table></figure><table><thead><tr><th>id</th><th>test_id</th><th>DB_TRX_ID</th><th>DB_ROLL_PT</th></tr></thead><tbody><tr><td>5</td><td>68</td><td>1</td><td>NULL</td></tr><tr><td>6</td><td>78</td><td>1</td><td>NULL</td></tr></tbody></table></li><li><p>修改数据库记录的时候</p><ol><li>更新原记录的删除版本号 (DB_ROLL_PT)为当前事务ID</li><li>插入一行新的更新后的记录,且它的数据行的版本号 （DB_TRX_ID）为当前事务ID</li></ol><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin;-- 获取全局系统事务ID 假设为 10</span><br><span class="line">update test_zq set test_id = 22 where id = 5;</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure><table><thead><tr><th>id</th><th>test_id</th><th>DB_TRX_ID</th><th>DB_ROLL_PT</th></tr></thead><tbody><tr><td>5</td><td>68</td><td>1</td><td>10</td></tr><tr><td>6</td><td>78</td><td>1</td><td>3</td></tr><tr><td>5</td><td>22</td><td>10</td><td>NULL</td></tr></tbody></table></li><li><p>查询的时候需要根据<code>数据行的版本号 （DB_TRX_ID）</code> 和 <code>删除版本号 (DB_ROLL_PT)</code> 二者进行数据数据筛选，需要同时满足以下规则：</p><ol><li><code>数据行的版本号 （DB_TRX_ID）</code> &lt;= 当前事务</li><li><code>删除版本号 (DB_ROLL_PT)</code> &gt; 当前事务</li></ol><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin;-- 假设拿到的系统事务ID为 10</span><br><span class="line">select * from test_zq;</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure><table><thead><tr><th>id</th><th>test_id</th><th>DB_TRX_ID</th><th>DB_ROLL_PT</th></tr></thead><tbody><tr><td>6</td><td>22</td><td>10</td><td>NULL</td></tr></tbody></table></li></ol><h2 id="2019-04-24-v2">2019-04-24</h2><h3 id="spring的lifecycle-springappilication生命周期-v2">Spring的Lifecycle (SpringAppilication生命周期)</h3><blockquote><p>Spring会拿到所有Lifecycle实现类，然后委托DefaultLifecycleProcessor进行逐个处理</p></blockquote><ul><li>Lifecycle 可以在SpringAppilication在初始化后执行start()方法,Spring停止的时候调用stop()方法</li><li>但是单单实现该类不能实现SpringAppilication在启动后,停止时调用Lifecycle对应的方法</li><li>这时候我们应该需要使用SmartLifecycle（Lifecycle的子类）,重写isAutoStartup()返回true，才能产生理想效果</li></ul><h2 id="2019-04-23-v2">2019-04-23</h2><h3 id="关于测试类的规范-v2">关于测试类的规范</h3><ol><li>单元测试应该是不依赖于别的单元测试的</li><li>所有单元测试应该都得回滚，如果存在异步处理的情况，应尽可能把主线程与fork线程拆成2个测试类方法进行测试</li><li>每个测试类／测试方法应写上对应的名称@DisplayName</li><li>每个接口，都必须写一个正向测试方法</li><li>关于测试类的类名：测试类与被测试的类的路径需要一致，名字也需要对应，如：</li></ol><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">com.fpx.wms.service.impl.InstockServiceImpl</span><br><span class="line">↓对应↓</span><br><span class="line">com.fpx.wms.service.impl.InstockServiceImplTest</span><br></pre></td></tr></table></figure><ol start="6"><li>关于测试类的方法名： 方法名尽可能为成功的条件如shouldSuccessAfterPay()，而方法具体用来测试哪个场景的，我们已经使用了@ DisplayName来描述，无须担心</li><li>对于结果，需要适应assert断言输出与结果是否一致（这才能算是一个单元测试）</li><li>断言统一使用AssertJ框架，使用Assertions.assertThat()进行处理</li></ol><h2 id="2019-04-22">2019-04-22</h2><h3 id="spring-lookup">Spring @Lookup</h3><h4 id="作用">作用</h4><blockquote><p>在单例A里 可能依赖到原型类型B,这时候如果用普通的Autowrite不能拿到原型的B，这时候就需要使用@Lockup了</p></blockquote><h4 id="使用参考">使用参考</h4><ul><li><a href="https://wangxiang5050.github.io/reading/2018/05/29/spring-lookup/" rel="external nofollow noopener noreferrer" target="_blank">参考地址</a></li><li><a href="https://www.baeldung.com/spring-lookup" rel="external nofollow noopener noreferrer" target="_blank">官网地址参考地址</a></li></ul><h2 id="2019-04-21">2019-04-21</h2><h3 id="架构设计三大原则">架构设计三大原则</h3><ul><li>合适原则</li><li>简单原则</li><li>演化原则</li></ul><blockquote><p>即，合适优于先进，简单优于复杂，演化优于一步到位<br> →能不分，尽可能不分</p></blockquote><h2 id="2019-03-20">2019-03-20</h2><h3 id="策略模式-vs-命令模式">策略模式 vs 命令模式</h3><h4 id="1-策略模式">1. 策略模式</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">策略模式针对一个命令,多种实现方式</span><br></pre></td></tr></table></figure><h4 id="2-命令模式">2. 命令模式</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">命令模式针对多个命令,每种命令都有各自的实现</span><br></pre></td></tr></table></figure><h4 id="3-总结">3. 总结</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">命令模式等于菜单中的复制，移动，压缩等，而策略模式是其中一个菜单的例如复制到不同算法实现。</span><br></pre></td></tr></table></figure><h2 id="2019-03-15">2019-03-15</h2><h3 id="策略模式-vs-代理模式">策略模式 vs 代理模式</h3><h4 id="1-策略模式-v2">1. 策略模式</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要调用方告知具体的策略</span><br></pre></td></tr></table></figure><h4 id="2-代理模式">2. 代理模式</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">需要调用方告知使用哪个[代理类]</span><br><span class="line">具体的【被代理类】由【代理类】生成，客户端不知道具体被代理的是谁</span><br></pre></td></tr></table></figure><h4 id="2-1-动态代理">2.1 动态代理</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要调用方告知[被代理类]及其接口</span><br></pre></td></tr></table></figure><h4 id="3-one-more-thing">3.One More Thing</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">以上模式都需要客户端告知具体的[策略]/[代理]/[被代理者]</span><br><span class="line">为了使实现其与调用方进行隔离,可以使用[**工厂模式**]进行隔离</span><br></pre></td></tr></table></figure><h2 id="2019-03-12">2019-03-12</h2><h3 id="spring循环依赖">Spring循环依赖</h3><p><code>场景现有3个类相互依赖，依赖关系分别为：</code></p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A--&gt;B</span><br><span class="line">B--&gt;C</span><br><span class="line">C--&gt;A</span><br></pre></td></tr></table></figure><p><code>场景细分为3种</code></p><ol><li>构造注入参数循环依赖(报错)<br> 报错</li></ol><blockquote><p>根据Spring初始化方式,Spring容器会按照顺序创建&quot;无属性&quot;的A放到<font size="1" color="red">“当前创建Bean池”</font>中，同理再B、C、A，但是在再次创建A的时候发现<font size="1" color="red">“当前创建Bean池”</font>已经存在A了，那么这时候会报错循环依赖</p></blockquote><ol start="2"><li>Setter注入的循环依赖(<code>单例</code>)<br> 没毛病，在set的时候对象ABC都已经实例化放在Spring缓存了好了</li><li>Setter注入的循环依赖(<code>prototype</code>)<br> 报错 <code>prototype</code>修饰的bean不会被Spring缓存,都是使用的时候当场创建的</li></ol><h3 id="spring注入方式选择">Spring注入方式选择</h3><p>结合上面的循环依赖问题，Setter出现问题的概率会低一些 推荐使用Setter注入</p><ol><li>构造注入</li><li>Setter注入</li><li>接口注入(没用过)</li></ol><h2 id="2019-03-11">2019-03-11</h2><h3 id="一-集合操作">一、集合操作</h3><h4 id="遍历">遍历</h4><ol><li>Enumeration(JDK1.0)<ul><li>只提供读集合相关功能，因为没有fail-fast，速度较快一点</li></ul></li><li>Iterator(<font color="red">推荐</font>)<ul><li>除了读功能，还有删除集合元素的能力，并且支持fail-fast（防止多线程同时对集合修改的一种机制）</li></ul></li></ol><h4 id="修改">修改</h4><p><font color="grean">正例：</font><br><br> 以List为例子,先得获取他的Iterator,通过iterator来进行修改操作<br><br><br> <font color="red">反例：</font><br><br> 使用增强型foreach进行add/remove操作：</p><blockquote><p>因为增强型foreach实际上是使用iterator实现的java语法糖:</p></blockquote><figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; userNames = <span class="hljs-keyword">new</span> ArrayList&lt;String&gt;() &#123;&#123;</span><br><span class="line">    add(<span class="hljs-string">"test1"</span>);</span><br><span class="line">    add(<span class="hljs-string">"test12"</span>);</span><br><span class="line">    add(<span class="hljs-string">"test13"</span>);</span><br><span class="line">    add(<span class="hljs-string">"test14"</span>);</span><br><span class="line">&#125;&#125;;</span><br><span class="line"><span class="hljs-keyword">for</span> (String userName : userNames) &#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (userName.equals(<span class="hljs-string">"test12"</span>)) &#123;</span><br><span class="line">        userNames.remove(userName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>编译后</strong></p><figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; userNames = <span class="hljs-keyword">new</span> ArrayList&lt;String&gt;() &#123;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.add(<span class="hljs-string">"test1"</span>);</span><br><span class="line">        <span class="hljs-keyword">this</span>.add(<span class="hljs-string">"test12"</span>);</span><br><span class="line">        <span class="hljs-keyword">this</span>.add(<span class="hljs-string">"test13"</span>);</span><br><span class="line">        <span class="hljs-keyword">this</span>.add(<span class="hljs-string">"test14"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Iterator var1 = userNames.iterator();</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">while</span>(var1.hasNext()) &#123;</span><br><span class="line">    String userName = (String)var1.next();</span><br><span class="line">    <span class="hljs-keyword">if</span> (userName.equals(<span class="hljs-string">"test12"</span>)) &#123;</span><br><span class="line">        userNames.remove(userName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">所以实际上for (String userName : userNames) 这里每次都会去调用itertor.next()</span><br><span class="line">如果你在迭代期间,操作了list.add()和list.remove()等不通过Iterator的操作</span><br><span class="line">next()里会去调用checkForComodification()方法</span><br><span class="line">然后发现modCount != expectedModCount 抛出异常</span><br><span class="line"></span><br><span class="line">因为list.add()和list.remove()等不通过Iterator的操作,是不会修改expectedModCount的</span><br></pre></td></tr></table></figure><h4 id="其它">其它</h4><ul><li><code>fail-fast：</code></li></ul><blockquote><p>防止多线程同时对集合修改的一种机制<br></p></blockquote><ul><li><code>modCount：</code></li></ul><blockquote><p>**<strong>List</strong>中的一个成员变量。它表示该集合实际被修改的次数</p></blockquote><ul><li><code>expectedModCount：</code></li></ul><blockquote><p>是 **<strong>List</strong>中的一个内部类——<font size="3" color="red">Itr中的成员变量</font></p></blockquote><h3 id="二-hystrix">二、Hystrix</h3><ol><li>Feign-starter包含Hystrix以及ribbon(只用他的均衡负载 http请求还是用feign自己的)</li><li>一个@FeignClient对应一个线程池或信号量</li><li>隔离<ul><li>线程池隔离</li></ul><blockquote><p><strong>tomcat的请求线程会交给线程池的线程处理</strong><br> 超过线程池会排队或者降级，一个线程池对应的服务挂了，不会影响别的线程池的服务</p></blockquote><ul><li>信号量隔离</li></ul><blockquote><p><strong>只作为开关</strong><br> 并发数超过X服务的信号量,多出来的Tomcat请求将会被拒绝</p></blockquote></li></ol><hr><h2 id="2019-03-05">2019-03-05</h2><h3 id="一-stringbuilder在高性能场景下的正确用法">一、StringBuilder在高性能场景下的正确用法</h3><p><a href="http://nathanchen.github.io/14596982516208.html" rel="external nofollow noopener noreferrer" target="_blank">StringBuilder在高性能场景下的正确用法</a></p><h2 id="2019-03-01">2019-03-01</h2><h3 id="一-分布式锁">一、分布式锁</h3><blockquote><p>从需求上说，分布式锁要求是不一样的：</p><ol><li>如果是用于聊天等社交场景,那么可以使用AP的分布式锁:Redis</li><li>如果是用于交易等不允许极端情况下获取锁不一致的，那么AP的Redis锁是不能接受的，这时候一定得用CP的分布式锁,如:etcd Zookeeper这一类</li></ol></blockquote><h2 id="2019-02-22">2019-02-22</h2><h3 id="一-threadlocal">一、ThreadLocal</h3><p><img src="/images/%E5%B9%B6%E5%8F%91/ThreadLocal.png" alt="ThreadLocal数据结构"></p><ol><li>每个线程都有一个ThreadLocalMap,ThreadLocalMap以Entry的形式保存着各个线程自己的数据</li><li>Entry为一个WeakReference,以你new的ThreadLocal为Key</li><li>基于2.当你new的ThreadLocal没被外部强引用时,线程该Thread下对应该ThreadLocal的Entry会在下次GC被回收</li></ol><h2 id="2019-02-17">2019-02-17</h2><h3 id="一-常量池">一、常量池</h3><p>常量池包含:</p><ol><li>class常量池 存在于class文件中</li><li>运行时常量池 存在于方法区中 一个类对应一个运行时常量池</li><li>字符串常量池 全局唯一 JDK6存在于方法区(独立于运行时常量池) JDK6以后存在于堆中</li></ol><h3 id="二-字符串加载到字符串常量池的2种方式">二、字符串加载到字符串常量池的2种方式</h3><pre class="mermaid">graph LR
A[编译后的class文件中的class常量池]
B[运行时常量池*N]
C[字符串常量池]
D[Java代码运行]
A-->B
D-->B
B-->C</pre><h2 id="2019-01-28">2019-01-28</h2><h3 id="mybatis">Mybatis</h3><h4 id="一级缓存">一级缓存</h4><blockquote><p>(范围为一个SqlSession)<br> 有Session/STATEMENT级别:</p></blockquote><ul><li>默认是SESSION 级别，即在一个MyBatis会<br> 话中执行的所有语句，都会共享这一个缓存。</li><li>一种是STATEMENT 级别，可以理解为缓存只对当前执行的<br> 这一个Statement 有效</li></ul><h4 id="二级缓存">二级缓存</h4><blockquote><p>基于mapper<br> 二级缓存开启后，同一个namespace下的所有操作语句，都影响着同一个Cache，即二级缓存被多个SqlSession共享</p></blockquote><h2 id="2018-11-06">2018-11-06</h2><h3 id="一-分布式事物要看场景的">一、 分布式事物要看场景的</h3><p>举个例子:</p><blockquote><ol><li>流量充值涉及到订单支付，金钱交易严格用tcc;</li><li>订单支付完后要给用户增加积分，这个必要成功，用最终消息一致性方案;</li><li>订单支付完后还要给用户发送一条短信，短信一般是跟电信运营商的第三方接口对接，有可能成功有可能失败，用最大努力通知方案</li></ol></blockquote><h2 id="more"><a id="more"></a></h2><h2 id="2018-11-06-v2">2018-11-06</h2><h3 id="一-jvm逃逸分析与tlab-thread-local-allocation-buffer">一、JVM逃逸分析与TLAB(Thread Local Allocation Buffer)</h3><blockquote><p>启动逃逸分析后,会分析没有逃逸的对象,把没有逃逸的对象分配在线程私有的栈里,性能提高5倍<br> TLAB(默认开启)存在于新生代,默认占其1%,为线程私有;因为线程私有,没有锁开销(对象分配的时候不需要锁住整个堆),效率高;</p></blockquote><blockquote><p>创建对象时内存分配流程:</p><ol><li>逃逸分析,确定分配在哪,如果是分配在堆则2</li><li>尽量分配在当前线程的TLAB,不够就去再申请一个TLAB,还不够则3</li><li>加锁Eden区,在Eden申请内存,不够则4,</li><li>执行Young GC</li><li>Young GC后,如果还不够,放入老年代</li></ol></blockquote><blockquote><p>对象分配流程写的不错<br> 参考:<a href="https://blog.csdn.net/yangzl2008/article/details/43202969" rel="external nofollow noopener noreferrer" target="_blank">https://blog.csdn.net/yangzl2008/article/details/43202969</a></p></blockquote><hr><h2 id="2018-10-19">2018-10-19</h2><h3 id="一-feign-consul-获取可用服务ip">一、Feign Consul 获取可用服务IP</h3><ul><li>HealthConsulClient.getHealthServices获取可用IP</li></ul><blockquote><p>通过http://consul.uat.i4px.com:8500/v1/health/service/pds-pos-outer?token=<br> 最终会在ConsulServerUtils.findHost()得到服务所对应的可用IP<br> IP获取逻辑是:</p><ol><li>获取Service.Address字段作为可用IP</li><li>取不到就取Node.Address</li></ol></blockquote><h3 id="二-consul">二、Consul</h3><blockquote><p>1.服务注销/删除<br> <a href="http://consul.uat.i4px.com:8500/v1/agent/service/deregister/fpx-prs-service-10-104-5-15-8002" rel="external nofollow noopener noreferrer" target="_blank">http://consul.uat.i4px.com:8500/v1/agent/service/deregister/fpx-prs-service-10-104-5-15-8002</a><br> 2.查看可用服务<br> <a href="http://consul.uat.i4px.com:8500/v1/health/service/wims?passing=true" rel="external nofollow noopener noreferrer" target="_blank">http://consul.uat.i4px.com:8500/v1/health/service/wims?passing=true</a></p></blockquote><hr><h2 id="2018-10-18">2018-10-18</h2><h3 id="一-多服务的-事务-阻塞-跨机器">一、多服务的【事务】阻塞（跨机器）</h3><ul><li>数据库锁分为读锁、写锁，读读共享，写写互斥，读写互斥</li><li>程序A正在开启事务,操作(包括CRUD) 数据库记录A时,A会被行级锁（读/写锁）;</li><li>其它程序若要对进行互斥锁操作,需要阻塞到该锁被释放(程序A提交事务)，</li></ul><hr><h2 id="2018-09-29">2018-09-29</h2><h3 id="一-接口返回的json数据-快速转换为实际数据">一、接口返回的JSON数据,快速转换为实际数据</h3><blockquote><p>ObjectMapper mapper = new ObjectMapper();<br> SimsPudo simsPudo = mapper.convertValue(responseMessage.getData(), SimsPudo.class);</p></blockquote><hr><h2 id="2018-09-29-v2">2018-09-29</h2><h3 id="一-xx-printflagsfinal">一、-XX:+PrintFlagsFinal</h3><blockquote><p>:=意味着值是被修改的, =表示默认值</p></blockquote><hr><h2 id="2018-09-29-v3">2018-09-29</h2><h3 id="一-feign重试">一、Feign重试</h3><ul><li>默认只会对connect timeout进行重试</li><li>OKToRetryOnAllOperations=true</li></ul><blockquote><ol><li>会对connect timeout和socket read timeout都进行重试,对socket read timeout会引起后端重复处理请求问题(需要做幂等)</li><li>Feign对于&gt;400的后端报错是不会重试的</li><li>设置了OKToRetryOnAllOperations=true所有后端需要幂等<br> OKToRetryOnAllOperations=false的前端需要做对应的超时异常处理,如:<br> 　　i.写代码自动重试<br> 　　ii.直接返回前台成功</li></ol></blockquote><h3 id="二-超时时间">二、超时时间</h3><ol><li>(socket)connect timeout 连接超时</li><li>(socket)read timeout 读超时</li></ol><blockquote><p>对read timout,请求已经到达后端处理,但是没在指定时间内返回</p></blockquote><h3 id="三-http状态码分类">三、Http状态码分类</h3><ol><li>1XX:正在处理</li><li>2XX:请求处理成功</li><li>3XX:请求需要重定向</li><li>4XX:服务器无法处理请求(U Fuck Off)</li><li>5XX:服务器处理请求出错(I Fuck Off)</li></ol><h3 id="四-string">四、String</h3><blockquote><ol><li>“ABC”:<br> 是显示声明的 以&quot;ABC&quot;形式存在于常量池中(常量池也在堆里)</li><li>new String(“ABC”):<br> 以对象形式存在于堆中</li><li>str.intern(),字符串(或引用)是否存在于常量池,不存在就把该引用存在常量池</li><li>“ABC”.intern() 没意思,本来就是放在常量池的东西,再调intern没用</li></ol></blockquote><h3 id="五-transaction">五、@Transaction</h3><blockquote><ol><li>@Transactional方法会覆盖类上的配置</li><li>调用被注入的代理类才能有效地激活@Transaction的效果</li></ol></blockquote><hr><h2 id="2018-09-28">2018-09-28</h2><h3 id="一-jvm参数配置">一、JVM参数配置</h3><blockquote><p>-XX:+PrintCommandLineFlags<br> 打印改动过的JVM参数<br> -XX:+PrintFlagsFinal打印最终在用的参数<br> -XX:+UnlockExperimentalVMOptions<br> -XX:+UnlockDiagnosticVMOptions<br> 显示隐藏参数</p></blockquote><h3 id="二-feign前后端全局异常处理">二、Feign前后端全局异常处理</h3><blockquote><ol><li>后端【业务代码直接抛异常】</li><li>后端全局异常捕获时【返回带异常信息的ResponseMsg】(一般不含堆栈信息),同时返回状态码设置为500(也可以404,因为Feign默认后端报错就是返回404)</li><li>前端(调用者)ErrorDecode时,解析该[ResponseMsg的异常信息],重新throw对应的异常就能保证前后端异常一致了</li></ol></blockquote><ul><li>[x] 对于需要进入fallback的调用</li></ul><blockquote><p>同上处理,但是按需可能需要使用FallbackFactory获取后端返回的异常信息进一步处理 如打印日志等</p></blockquote><ul><li>[ ] 问题:可能导致前端(调用方)不能切换实例重试</li><li>[ ] 加入Decode404=true后,404错误不会进入ErrorDecode和Fallback</li></ul><hr><h2 id="2018-09-17">2018-09-17</h2><h3 id="一-正确的kill进程">一、正确的kill进程</h3><blockquote><p>先kill -15(安全关闭 回收资源)<br> 不行再kill -9(强制关闭)</p></blockquote><h2 id="2018-09-16">2018-09-16</h2><h3 id="一-jdk8-移除了perm">一、JDK8+移除了Perm</h3><blockquote><p>jdk8移除了Perm<br> 其方法区及常量池等数据,全部移到了元数据区(Metaspace)中</p></blockquote><h3 id="二-string-intern">二、String.intern</h3><blockquote><p>JDK7及以后版本,是复制其字符串引用到常量池中<br> 实际数据还是存在于堆中</p></blockquote><h3 id="二-xx-metaspacesize">二、-XX:MetaspaceSize</h3><blockquote><p>-XX:MetaspaceSize=200m不是初始元空间大小,而是达到了200m后才会对该区域进行GC</p></blockquote><hr><h2 id="2018-09-06">2018-09-06</h2><h3 id="一-获取全局唯一id">一、获取全局唯一ID</h3><blockquote><ol><li>redis: 服务器时间戳+redis全局自增id=&gt;UUID<br> 简单、快捷</li><li>zk:同上<br> 比较慢</li><li>通过数据库<br> 慢、并发低</li><li>twitter的雪花算法: 通过时间戳+机器ID=&gt;UUID<br> 优势:速度快、无需依赖中间件、全局唯一</li></ol><p>实现参考：<a href="https://github.com/souyunku/SnowFlake" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/souyunku/SnowFlake</a></p></blockquote><hr><h2 id="2018-09-05">2018-09-05</h2><h3 id="一-sql的强制索引">一、SQL的强制索引</h3><blockquote><p>select * from parcel <strong>FORCE INDEX(uniq_fpx_tracking_no_1)</strong> where fpx_tracking_no not in (‘901000486441’,‘901000497454’) ;</p></blockquote><h3 id="二-接口幂等理解">二、接口幂等理解</h3><ol><li><p>分布式锁实现幂等的方式</p><ol><li><ul><li>查询缓存结果,存在就返回</li></ul></li><li><ul><li>不存在,获取分布式锁(阻塞等待)</li></ul></li><li><ul><li>再尝试第一步</li></ul></li><li><ul><li>不存在,开始执行业务逻辑,并且缓存结果</li></ul></li><li><ul><li>释放锁</li></ul></li></ol></li><li><p>分布式锁实现的幂等,不完全可靠,因为缓存会过期</p><ol><li>要保证其绝对可靠,还是得使用select+insert、唯一索引等方式</li></ol></li></ol><h3 id="三-io多路复用模型">三、IO多路复用模型</h3><p><a href="https://mp.weixin.qq.com/s/xmSn9Xz6MiFb2s_0J7iXwQ" rel="external nofollow noopener noreferrer" target="_blank">https://mp.weixin.qq.com/s/xmSn9Xz6MiFb2s_0J7iXwQ</a></p><blockquote><ol><li>单Reactor单线程(Redis)</li><li>单Reactor多线程</li><li>多Reactor多线程</li></ol></blockquote></div><div class="level is-size-7 is-uppercase"><div class="level-start"><div class="level-item"> <span class="is-size-6 has-text-grey has-mr-7">#</span> <a class="has-link-grey -link" href="/tags/每天进步一点点/">每天进步一点点</a></div></div></div></div><div style="text-align:center;color:#ccc;font-size:14px"> ------ 本文结束<i class="fa fa-paw"></i>感谢您的阅读 ------</div></div><div class="card card-transparent"><div class="level post-navigation is-flex-wrap is-mobile"><div class="level-start"><a class="level level-item has-link-grey article-nav-prev" href="/Bug-Log-Optimization/bug_in_spring-cloud_instance_registered_with_consul.html"><i class="level-item fas fa-chevron-left"></i> <span class="level-item">Spring-Cloud服务在Consul中的多实例注册问题</span></a></div><div class="level-end"> <a class="level level-item has-link-grey article-nav-next" href="/redis/Redis-Install-Settring.html"><span class="level-item">1分钟教你redis集群搭建（2服務器）</span><i class="level-item fas fa-chevron-right"></i></a></div></div></div><div class="card"><div class="card-content"><h3 class="title is-5 has-text-weight-normal">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://jjeejj.github.io/css/gitment.css"><script src="https://jjeejj.github.io/js/gitment.js"></script><script>var gitment=new Gitment({id:"Wed Sep 05 2018 14:44:56 GMT+0800",owner:"HeyFL",repo:"heyfl.github.io",oauth:{client_id:"5e29b8e11983abda2f99",client_secret:"1ebe24de503d7b6a285f9e4ac48fe6cad3f37cbe"}});gitment.render("comment-container")</script></div></div></div><div class="column is-4-tablet is-4-desktop is-3-widescreen has-order-1 column-left"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered"><div><figure class="image container is-128x128 has-mb-6"> <img class="is-rounded" src="/images/avatar.png" alt="Pokémon Master"></figure><p class="is-size-4 is-block"> Pokémon Master</p><p class="is-size-6 is-block"> Web Developer &amp; Designer</p><p class="is-size-6 is-flex is-flex-center has-text-grey"><i class="fas fa-map-marker-alt has-mr-7"></i> <span>ShenZhen, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading"> 文章</p><p class="title has-text-weight-normal"> 11</p></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading"> 分类</p><p class="title has-text-weight-normal"> 8</p></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading"> 标签</p><p class="title has-text-weight-normal"> 16</p></div></div></nav><div class="level"> <a class="level-item button is-link is-rounded" href="https://github.com/HeyFL" rel="external nofollow noopener noreferrer" target="_blank">关注我</a></div><div class="level is-mobile"><a class="level-item button is-white is-marginless" target="_blank" title="Github" href="https://github.com/HeyFL" rel="external nofollow noopener noreferrer"><i class="fab fa-github"></i></a><a class="level-item button is-white is-marginless" target="_blank" title="QQ(361389383)" href="tencent://message/?uin=361389383" rel="external nofollow noopener noreferrer"><i class="fab fa-qq"></i></a></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label"> 分类</h3><ul class="menu-list"><li> <a class="level is-marginless" href="/categories/Bug-Log-Optimization/"><span class="level-start"><span class="level-item">Bug-Log&Optimization</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/categories/Distributed/"><span class="level-start"><span class="level-item">Distributed</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/categories/JVM/"><span class="level-start"><span class="level-item">JVM</span></span> <span class="level-end"><span class="level-item tag">2</span></span></a></li><li> <a class="level is-marginless" href="/categories/Make-A-Little-Progress-Every-Day/"><span class="level-start"><span class="level-item">Make-A-Little-Progress-Every-Day</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/categories/Spring/"><span class="level-start"><span class="level-item">Spring</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/categories/about/"><span class="level-start"><span class="level-item">about</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/categories/database/"><span class="level-start"><span class="level-item">database</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/categories/redis/"><span class="level-start"><span class="level-item">redis</span></span> <span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label"> 目录</h3><ul class="menu-list"><li> <a class="is-flex" href="#2019-08-26"><span class="has-mr-6">1</span> <span>2019-08-26</span></a><ul class="menu-list"><li> <a class="is-flex" href="#mysql锁"><span class="has-mr-6">1.1</span> <span>MySQL锁</span></a><ul class="menu-list"><li> <a class="is-flex" href="#记录锁"><span class="has-mr-6">1.1.1</span> <span>记录锁</span></a></li><li> <a class="is-flex" href="#间隙锁"><span class="has-mr-6">1.1.2</span> <span>间隙锁</span></a></li></ul></li></ul></li><li> <a class="is-flex" href="#2019-08-22"><span class="has-mr-6">2</span> <span>2019-08-22</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring事务-aop增强"><span class="has-mr-6">2.1</span> <span>Spring事务/AOP增强</span></a></li><li> <a class="is-flex" href="#spring-ltw实现的静态织入-应该不能叫做代理"><span class="has-mr-6">2.2</span> <span>Spring LTW实现的静态织入（应该不能叫做代理）</span></a></li></ul></li><li> <a class="is-flex" href="#2019-08-01"><span class="has-mr-6">3</span> <span>2019-08-01</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring事务"><span class="has-mr-6">3.1</span> <span>Spring事务</span></a></li></ul></li><li> <a class="is-flex" href="#2019-7-20"><span class="has-mr-6">4</span> <span>2019-7-20</span></a><ul class="menu-list"><li> <a class="is-flex" href="#seata"><span class="has-mr-6">4.1</span> <span>seata</span></a></li></ul></li><li> <a class="is-flex" href="#2019-7-17"><span class="has-mr-6">5</span> <span>2019-7-17</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring事务-cglib"><span class="has-mr-6">5.1</span> <span>Spring事务/Cglib</span></a></li></ul></li><li> <a class="is-flex" href="#2019-5-20"><span class="has-mr-6">6</span> <span>2019-5-20</span></a><ul class="menu-list"><li> <a class="is-flex" href="#gc日志-gc耗时解析"><span class="has-mr-6">6.1</span> <span>【GC日志】GC耗时解析</span></a></li></ul></li><li> <a class="is-flex" href="#2019-5-1"><span class="has-mr-6">7</span> <span>2019-5-1</span></a><ul class="menu-list"><li> <a class="is-flex" href="#数据库mvcc"><span class="has-mr-6">7.1</span> <span>数据库MVCC</span></a><ul class="menu-list"><li> <a class="is-flex" href="#mvvc机制："><span class="has-mr-6">7.1.1</span> <span>MVVC机制：</span></a></li></ul></li></ul></li><li> <a class="is-flex" href="#2019-04-24"><span class="has-mr-6">8</span> <span>2019-04-24</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring的lifecycle-springappilication生命周期"><span class="has-mr-6">8.1</span> <span>Spring的Lifecycle (SpringAppilication生命周期)</span></a></li></ul></li><li> <a class="is-flex" href="#2019-04-23"><span class="has-mr-6">9</span> <span>2019-04-23</span></a><ul class="menu-list"><li> <a class="is-flex" href="#关于测试类的规范"><span class="has-mr-6">9.1</span> <span>关于测试类的规范</span></a></li></ul></li><li> <a class="is-flex" href="#2019-08-22-v2"><span class="has-mr-6">10</span> <span>2019-08-22</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring事务-aop增强-v2"><span class="has-mr-6">10.1</span> <span>Spring事务/AOP增强</span></a></li></ul></li><li> <a class="is-flex" href="#2019-08-01-v2"><span class="has-mr-6">11</span> <span>2019-08-01</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring事务-v2"><span class="has-mr-6">11.1</span> <span>Spring事务</span></a></li></ul></li><li> <a class="is-flex" href="#2019-7-20-v2"><span class="has-mr-6">12</span> <span>2019-7-20</span></a><ul class="menu-list"><li> <a class="is-flex" href="#seata-v2"><span class="has-mr-6">12.1</span> <span>seata</span></a></li></ul></li><li> <a class="is-flex" href="#2019-7-17-v2"><span class="has-mr-6">13</span> <span>2019-7-17</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring事务-cglib-v2"><span class="has-mr-6">13.1</span> <span>Spring事务/Cglib</span></a></li></ul></li><li> <a class="is-flex" href="#2019-5-20-v2"><span class="has-mr-6">14</span> <span>2019-5-20</span></a><ul class="menu-list"><li> <a class="is-flex" href="#gc日志-gc耗时解析-v2"><span class="has-mr-6">14.1</span> <span>【GC日志】GC耗时解析</span></a></li></ul></li><li> <a class="is-flex" href="#2019-5-1-v2"><span class="has-mr-6">15</span> <span>2019-5-1</span></a><ul class="menu-list"><li> <a class="is-flex" href="#数据库mvcc-v2"><span class="has-mr-6">15.1</span> <span>数据库MVCC</span></a></li></ul></li><li> <a class="is-flex" href="#2019-04-24-v2"><span class="has-mr-6">16</span> <span>2019-04-24</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring的lifecycle-springappilication生命周期-v2"><span class="has-mr-6">16.1</span> <span>Spring的Lifecycle (SpringAppilication生命周期)</span></a></li></ul></li><li> <a class="is-flex" href="#2019-04-23-v2"><span class="has-mr-6">17</span> <span>2019-04-23</span></a><ul class="menu-list"><li> <a class="is-flex" href="#关于测试类的规范-v2"><span class="has-mr-6">17.1</span> <span>关于测试类的规范</span></a></li></ul></li><li> <a class="is-flex" href="#2019-04-22"><span class="has-mr-6">18</span> <span>2019-04-22</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring-lookup"><span class="has-mr-6">18.1</span> <span>Spring @Lookup</span></a><ul class="menu-list"><li> <a class="is-flex" href="#作用"><span class="has-mr-6">18.1.1</span> <span>作用</span></a></li><li> <a class="is-flex" href="#使用参考"><span class="has-mr-6">18.1.2</span> <span>使用参考</span></a></li></ul></li></ul></li><li> <a class="is-flex" href="#2019-04-21"><span class="has-mr-6">19</span> <span>2019-04-21</span></a><ul class="menu-list"><li> <a class="is-flex" href="#架构设计三大原则"><span class="has-mr-6">19.1</span> <span>架构设计三大原则</span></a></li></ul></li><li> <a class="is-flex" href="#2019-03-20"><span class="has-mr-6">20</span> <span>2019-03-20</span></a><ul class="menu-list"><li> <a class="is-flex" href="#策略模式-vs-命令模式"><span class="has-mr-6">20.1</span> <span>策略模式 vs 命令模式</span></a><ul class="menu-list"><li> <a class="is-flex" href="#1-策略模式"><span class="has-mr-6">20.1.1</span> <span>1. 策略模式</span></a></li><li> <a class="is-flex" href="#2-命令模式"><span class="has-mr-6">20.1.2</span> <span>2. 命令模式</span></a></li><li> <a class="is-flex" href="#3-总结"><span class="has-mr-6">20.1.3</span> <span>3. 总结</span></a></li></ul></li></ul></li><li> <a class="is-flex" href="#2019-03-15"><span class="has-mr-6">21</span> <span>2019-03-15</span></a><ul class="menu-list"><li> <a class="is-flex" href="#策略模式-vs-代理模式"><span class="has-mr-6">21.1</span> <span>策略模式 vs 代理模式</span></a><ul class="menu-list"><li> <a class="is-flex" href="#1-策略模式-v2"><span class="has-mr-6">21.1.1</span> <span>1. 策略模式</span></a></li><li> <a class="is-flex" href="#2-代理模式"><span class="has-mr-6">21.1.2</span> <span>2. 代理模式</span></a></li><li> <a class="is-flex" href="#2-1-动态代理"><span class="has-mr-6">21.1.3</span> <span>2.1 动态代理</span></a></li><li> <a class="is-flex" href="#3-one-more-thing"><span class="has-mr-6">21.1.4</span> <span>3.One More Thing</span></a></li></ul></li></ul></li><li> <a class="is-flex" href="#2019-03-12"><span class="has-mr-6">22</span> <span>2019-03-12</span></a><ul class="menu-list"><li> <a class="is-flex" href="#spring循环依赖"><span class="has-mr-6">22.1</span> <span>Spring循环依赖</span></a></li><li> <a class="is-flex" href="#spring注入方式选择"><span class="has-mr-6">22.2</span> <span>Spring注入方式选择</span></a></li></ul></li><li> <a class="is-flex" href="#2019-03-11"><span class="has-mr-6">23</span> <span>2019-03-11</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-集合操作"><span class="has-mr-6">23.1</span> <span>一、集合操作</span></a><ul class="menu-list"><li> <a class="is-flex" href="#遍历"><span class="has-mr-6">23.1.1</span> <span>遍历</span></a></li><li> <a class="is-flex" href="#修改"><span class="has-mr-6">23.1.2</span> <span>修改</span></a></li><li> <a class="is-flex" href="#其它"><span class="has-mr-6">23.1.3</span> <span>其它</span></a></li></ul></li><li> <a class="is-flex" href="#二-hystrix"><span class="has-mr-6">23.2</span> <span>二、Hystrix</span></a></li></ul></li><li> <a class="is-flex" href="#2019-03-05"><span class="has-mr-6">24</span> <span>2019-03-05</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-stringbuilder在高性能场景下的正确用法"><span class="has-mr-6">24.1</span> <span>一、StringBuilder在高性能场景下的正确用法</span></a></li></ul></li><li> <a class="is-flex" href="#2019-03-01"><span class="has-mr-6">25</span> <span>2019-03-01</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-分布式锁"><span class="has-mr-6">25.1</span> <span>一、分布式锁</span></a></li></ul></li><li> <a class="is-flex" href="#2019-02-22"><span class="has-mr-6">26</span> <span>2019-02-22</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-threadlocal"><span class="has-mr-6">26.1</span> <span>一、ThreadLocal</span></a></li></ul></li><li> <a class="is-flex" href="#2019-02-17"><span class="has-mr-6">27</span> <span>2019-02-17</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-常量池"><span class="has-mr-6">27.1</span> <span>一、常量池</span></a></li><li> <a class="is-flex" href="#二-字符串加载到字符串常量池的2种方式"><span class="has-mr-6">27.2</span> <span>二、字符串加载到字符串常量池的2种方式</span></a></li></ul></li><li> <a class="is-flex" href="#2019-01-28"><span class="has-mr-6">28</span> <span>2019-01-28</span></a><ul class="menu-list"><li> <a class="is-flex" href="#mybatis"><span class="has-mr-6">28.1</span> <span>Mybatis</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一级缓存"><span class="has-mr-6">28.1.1</span> <span>一级缓存</span></a></li><li> <a class="is-flex" href="#二级缓存"><span class="has-mr-6">28.1.2</span> <span>二级缓存</span></a></li></ul></li></ul></li><li> <a class="is-flex" href="#2018-11-06"><span class="has-mr-6">29</span> <span>2018-11-06</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-分布式事物要看场景的"><span class="has-mr-6">29.1</span> <span>一、 分布式事物要看场景的</span></a></li></ul></li><li> <a class="is-flex" href="#more"><span class="has-mr-6">30</span><span></span></a></li><li> <a class="is-flex" href="#2018-11-06-v2"><span class="has-mr-6">31</span> <span>2018-11-06</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-jvm逃逸分析与tlab-thread-local-allocation-buffer"><span class="has-mr-6">31.1</span> <span>一、JVM逃逸分析与TLAB(Thread Local Allocation Buffer)</span></a></li></ul></li><li> <a class="is-flex" href="#2018-10-19"><span class="has-mr-6">32</span> <span>2018-10-19</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-feign-consul-获取可用服务ip"><span class="has-mr-6">32.1</span> <span>一、Feign Consul 获取可用服务IP</span></a></li><li> <a class="is-flex" href="#二-consul"><span class="has-mr-6">32.2</span> <span>二、Consul</span></a></li></ul></li><li> <a class="is-flex" href="#2018-10-18"><span class="has-mr-6">33</span> <span>2018-10-18</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-多服务的-事务-阻塞-跨机器"><span class="has-mr-6">33.1</span> <span>一、多服务的【事务】阻塞（跨机器）</span></a></li></ul></li><li> <a class="is-flex" href="#2018-09-29"><span class="has-mr-6">34</span> <span>2018-09-29</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-接口返回的json数据-快速转换为实际数据"><span class="has-mr-6">34.1</span> <span>一、接口返回的JSON数据,快速转换为实际数据</span></a></li></ul></li><li> <a class="is-flex" href="#2018-09-29-v2"><span class="has-mr-6">35</span> <span>2018-09-29</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-xx-printflagsfinal"><span class="has-mr-6">35.1</span> <span>一、-XX:+PrintFlagsFinal</span></a></li></ul></li><li> <a class="is-flex" href="#2018-09-29-v3"><span class="has-mr-6">36</span> <span>2018-09-29</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-feign重试"><span class="has-mr-6">36.1</span> <span>一、Feign重试</span></a></li><li> <a class="is-flex" href="#二-超时时间"><span class="has-mr-6">36.2</span> <span>二、超时时间</span></a></li><li> <a class="is-flex" href="#三-http状态码分类"><span class="has-mr-6">36.3</span> <span>三、Http状态码分类</span></a></li><li> <a class="is-flex" href="#四-string"><span class="has-mr-6">36.4</span> <span>四、String</span></a></li><li> <a class="is-flex" href="#五-transaction"><span class="has-mr-6">36.5</span> <span>五、@Transaction</span></a></li></ul></li><li> <a class="is-flex" href="#2018-09-28"><span class="has-mr-6">37</span> <span>2018-09-28</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-jvm参数配置"><span class="has-mr-6">37.1</span> <span>一、JVM参数配置</span></a></li><li> <a class="is-flex" href="#二-feign前后端全局异常处理"><span class="has-mr-6">37.2</span> <span>二、Feign前后端全局异常处理</span></a></li></ul></li><li> <a class="is-flex" href="#2018-09-17"><span class="has-mr-6">38</span> <span>2018-09-17</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-正确的kill进程"><span class="has-mr-6">38.1</span> <span>一、正确的kill进程</span></a></li></ul></li><li> <a class="is-flex" href="#2018-09-16"><span class="has-mr-6">39</span> <span>2018-09-16</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-jdk8-移除了perm"><span class="has-mr-6">39.1</span> <span>一、JDK8+移除了Perm</span></a></li><li> <a class="is-flex" href="#二-string-intern"><span class="has-mr-6">39.2</span> <span>二、String.intern</span></a></li><li> <a class="is-flex" href="#二-xx-metaspacesize"><span class="has-mr-6">39.3</span> <span>二、-XX:MetaspaceSize</span></a></li></ul></li><li> <a class="is-flex" href="#2018-09-06"><span class="has-mr-6">40</span> <span>2018-09-06</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-获取全局唯一id"><span class="has-mr-6">40.1</span> <span>一、获取全局唯一ID</span></a></li></ul></li><li> <a class="is-flex" href="#2018-09-05"><span class="has-mr-6">41</span> <span>2018-09-05</span></a><ul class="menu-list"><li> <a class="is-flex" href="#一-sql的强制索引"><span class="has-mr-6">41.1</span> <span>一、SQL的强制索引</span></a></li><li> <a class="is-flex" href="#二-接口幂等理解"><span class="has-mr-6">41.2</span> <span>二、接口幂等理解</span></a></li><li> <a class="is-flex" href="#三-io多路复用模型"><span class="has-mr-6">41.3</span> <span>三、IO多路复用模型</span></a></li></ul></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"><div class="card widget"><div class="card-content"><h3 class="menu-label"> 最新文章</h3><article class="media"><a href="/database/innodb-record-level-locks.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="MySQL锁"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-26T10:59:26.000Z">2019-08-26</time></div> <a href="/database/innodb-record-level-locks.html" class="has-link-black-ter is-size-6">MySQL锁</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/database/">database</a></p></div></div></article><article class="media"><a href="/Spring/Spring-Circular-Dependencies.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="【Spring源码分析】循环依赖的处理"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-05-22T03:22:00.000Z">2019-05-22</time></div> <a href="/Spring/Spring-Circular-Dependencies.html" class="has-link-black-ter is-size-6">【Spring源码分析】循环依赖的处理</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/Spring/">Spring</a></p></div></div></article><article class="media"><a href="/JVM/JVM-Memory-Structure-Stack.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="java虚拟机栈的内存结构"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-19T13:22:00.000Z">2019-02-19</time></div> <a href="/JVM/JVM-Memory-Structure-Stack.html" class="has-link-black-ter is-size-6">java虚拟机栈的内存结构</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/JVM/">JVM</a></p></div></div></article><article class="media"><a href="/JVM/JVM-Memory-Structure-Menu.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="JVM内存结构-总纲"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-16T05:21:00.000Z">2019-02-16</time></div> <a href="/JVM/JVM-Memory-Structure-Menu.html" class="has-link-black-ter is-size-6">JVM内存结构-总纲</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/JVM/">JVM</a></p></div></div></article><article class="media"><a href="/redis/Redis-Partitioning.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="Redis分片方案概要(Cluster or Codis)"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-15T07:21:00.000Z">2019-02-15</time></div> <a href="/redis/Redis-Partitioning.html" class="has-link-black-ter is-size-6">Redis分片方案概要(Cluster or Codis)</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/redis/">redis</a></p></div></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label"> 归档</h3><ul class="menu-list"><li> <a class="level is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">八月 2019</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">五月 2019</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">二月 2019</span></span> <span class="level-end"><span class="level-item tag">5</span></span></a></li><li> <a class="level is-marginless" href="/archives/2018/10/"><span class="level-start"><span class="level-item">十月 2018</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/2018/09/"><span class="level-start"><span class="level-item">九月 2018</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/2017/03/"><span class="level-start"><span class="level-item">三月 2017</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/1970/12/"><span class="level-start"><span class="level-item">十二月 1970</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label"> 标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"> <a class="tags has-addons" href="/tags/BUG/"><span class="tag">BUG</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/Consul/"><span class="tag">Consul</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/DATABASE/"><span class="tag">DATABASE</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/JVM/"><span class="tag">JVM</span> <span class="tag is-grey">2</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/JVM内存结构/"><span class="tag">JVM内存结构</span> <span class="tag is-grey">2</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/LOCK/"><span class="tag">LOCK</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/MYSQL/"><span class="tag">MYSQL</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/Spring/"><span class="tag">Spring</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/Spring-Cloud/"><span class="tag">Spring-Cloud</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/redis/"><span class="tag">redis</span> <span class="tag is-grey">3</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/redis集群/"><span class="tag">redis集群</span> <span class="tag is-grey">2</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/事务/"><span class="tag">事务</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/优化/"><span class="tag">优化</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/分布式/"><span class="tag">分布式</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/每天进步一点点/"><span class="tag">每天进步一点点</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/源码分析/"><span class="tag">源码分析</span> <span class="tag is-grey">1</span></a></div></div></div></div></div></div></div><div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right"><div class="card widget"><div class="card-content"><h3 class="menu-label"> 最新文章</h3><article class="media"><a href="/database/innodb-record-level-locks.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="MySQL锁"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-26T10:59:26.000Z">2019-08-26</time></div> <a href="/database/innodb-record-level-locks.html" class="has-link-black-ter is-size-6">MySQL锁</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/database/">database</a></p></div></div></article><article class="media"><a href="/Spring/Spring-Circular-Dependencies.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="【Spring源码分析】循环依赖的处理"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-05-22T03:22:00.000Z">2019-05-22</time></div> <a href="/Spring/Spring-Circular-Dependencies.html" class="has-link-black-ter is-size-6">【Spring源码分析】循环依赖的处理</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/Spring/">Spring</a></p></div></div></article><article class="media"><a href="/JVM/JVM-Memory-Structure-Stack.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="java虚拟机栈的内存结构"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-19T13:22:00.000Z">2019-02-19</time></div> <a href="/JVM/JVM-Memory-Structure-Stack.html" class="has-link-black-ter is-size-6">java虚拟机栈的内存结构</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/JVM/">JVM</a></p></div></div></article><article class="media"><a href="/JVM/JVM-Memory-Structure-Menu.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="JVM内存结构-总纲"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-16T05:21:00.000Z">2019-02-16</time></div> <a href="/JVM/JVM-Memory-Structure-Menu.html" class="has-link-black-ter is-size-6">JVM内存结构-总纲</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/JVM/">JVM</a></p></div></div></article><article class="media"><a href="/redis/Redis-Partitioning.html" class="media-left"><p class="image is-64x64"> <img class="thumbnail" src="/images/thumbnail.svg" alt="Redis分片方案概要(Cluster or Codis)"></p></a><div class="media-content"><div class="content"><div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-15T07:21:00.000Z">2019-02-15</time></div> <a href="/redis/Redis-Partitioning.html" class="has-link-black-ter is-size-6">Redis分片方案概要(Cluster or Codis)</a><p class="is-size-7 is-uppercase"> <a class="has-link-grey -link" href="/categories/redis/">redis</a></p></div></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label"> 归档</h3><ul class="menu-list"><li> <a class="level is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">八月 2019</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">五月 2019</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">二月 2019</span></span> <span class="level-end"><span class="level-item tag">5</span></span></a></li><li> <a class="level is-marginless" href="/archives/2018/10/"><span class="level-start"><span class="level-item">十月 2018</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/2018/09/"><span class="level-start"><span class="level-item">九月 2018</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/2017/03/"><span class="level-start"><span class="level-item">三月 2017</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li><li> <a class="level is-marginless" href="/archives/1970/12/"><span class="level-start"><span class="level-item">十二月 1970</span></span> <span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label"> 标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"> <a class="tags has-addons" href="/tags/BUG/"><span class="tag">BUG</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/Consul/"><span class="tag">Consul</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/DATABASE/"><span class="tag">DATABASE</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/JVM/"><span class="tag">JVM</span> <span class="tag is-grey">2</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/JVM内存结构/"><span class="tag">JVM内存结构</span> <span class="tag is-grey">2</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/LOCK/"><span class="tag">LOCK</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/MYSQL/"><span class="tag">MYSQL</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/Spring/"><span class="tag">Spring</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/Spring-Cloud/"><span class="tag">Spring-Cloud</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/redis/"><span class="tag">redis</span> <span class="tag is-grey">3</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/redis集群/"><span class="tag">redis集群</span> <span class="tag is-grey">2</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/事务/"><span class="tag">事务</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/优化/"><span class="tag">优化</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/分布式/"><span class="tag">分布式</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/每天进步一点点/"><span class="tag">每天进步一点点</span> <span class="tag is-grey">1</span></a></div><div class="control"> <a class="tags has-addons" href="/tags/源码分析/"><span class="tag">源码分析</span> <span class="tag is-grey">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div id="power-count"><div class="outer"><div id="footer-info" class="inner"> &copy;2018 - 2019 神奇宝贝大师版权所有<br></div></div><div class="powered-by"><i class="fa fa-mouse-pointer"></i> <span id="busuanzi_container_site_pv">访问量:<span class="foot-count" id="busuanzi_value_site_pv">N^N</span></span><i class="fa fa-user"></i> <span id="busuanzi_container_site_uv">您是第<span class="foot-count" id="busuanzi_value_site_uv">N+1</span>个小伙伴</span></div></div><div class="container"><div class="level"><div class="level-start has-text-centered-mobile"> <a class="footer-logo is-block has-mb-6" href="/"><img src="/images/avatar.png" alt="每天进步一点点" height="28"></a><p class="is-size-7"> &copy; 2019 神奇宝贝大师&nbsp; Powered by <a href="http://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a></p></div><div class="level-end"><div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle"><p class="control"><a class="button is-white is-large" target="_blank" title="GitHub" href="https://github.com/HeyFL" rel="external nofollow noopener noreferrer"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://unpkg.com/mermaid@8.0.0/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script><script>function eventDelegate(e,n,t,l){function o(e){var t=e||window.event,o=t.target||t.srcElement,r=t.currentTarget;for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),o=t.length;0<=--o&&t.item(o)!==this;);return-1<o});o!==r;){if(o.matches(n)){var c=o;l.call(c,Array.prototype.slice.call(arguments))}o=o.parentNode}}t.split(".").forEach(function(t){Array.prototype.slice.call(document.querySelectorAll(e)).forEach(function(e){e.addEventListener(t,o)})})}eventDelegate("body",".gitter-open-chat-button","click",function(){$("#live2d-widget").attr("style","display:none")}),eventDelegate("body",".gitter-chat-embed-action-bar-item.gitter-chat-embed-action-bar-item-collapse-chat","click",function(){$("#live2d-widget").attr("style","")})</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN")</script><script src="/js/animation.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer="defer"></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer="defer"></script><script src="/js/gallery.js" defer="defer"></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" rel="external nofollow noopener noreferrer" target="_blank">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer="defer"></script><script>document.addEventListener("DOMContentLoaded",function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"flex"})})</script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back-to-top.js" defer="defer"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer="defer"></script><script src="/js/clipboard.js" defer="defer"></script><script src="/js/main.js" defer="defer"></script><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(无标题)"},CONTENT_URL:"/content.json"}</script><script src="/js/insight.js" defer="defer"></script><link rel="stylesheet" href="/css/search.css"><link rel="stylesheet" href="/css/insight.css"><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/shizuku.model.json"},display:{position:"right",width:80,height:150},mobile:{show:!1}})</script></body></html>